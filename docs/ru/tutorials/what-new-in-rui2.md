# Что нового в RightJS UI 2

Как вы наверное уже знаете, релиз RightJS 2 имеет несколько существенных 
изменений в дизайне и выпускается как полный рестарт фреймворка.

RightJS UI 2 - это часть плана пу... по захвату власти над миром. Посему
несколько историй о том что нового и интересного происходит.


## Виджеты == DOM-Элементы, :elements

Одно из наиболее существенных изменений в RightJS 2 это то что мы переходим
от прямого доступа к элементам страниц к использованию dom-оберток. И одно из
интересных последствий данного перехода в том, что теперь вы вольны создавать
столько приватных типов сколько вам заблагорассудится.

В следствии чего, все виджеты в RightJS UI 2 являются приватными типами
унаследованными от класса {Element}, а это означает, что виджеты теперь
являются равноправными элементами страниц и вы можете работать с ними точно
так же как с любым объектом типа {Element}

    var calendar = new Calendar();
    
    calendar
      .insertTo('my-element', 'top')
      .set('id', 'my-calendar')
      .addClass('my-calendar')
      .onClick('toggleClass', 'clicked')
      // и т.д. .....

Естественно корректно поддерживается типизация объектов

    calendar instanceof Calendar; // true
    calendar instanceof Element;  // true
    calendar instanceof Window;   // false

RightJS будет так же автоматически регистрировать все ваши виджеты в системе
и использовать их по умолчанию во время навигации по странице

    $('my-calendar');        // -> calendar
    $$('.my-calendar')[0];   // -> calendar
    $('my-element').first(); // -> calendar

В целом, вы можете делать с виджетами в точности все тоже самое что и с любым
другим элементом страницы.


## Новая обработка событий, :events

Т.к. все виджеты теперь по сути являются элементами страницы, а так же ввиду
того что все события теперь честно всплывают по дереву документа, способ
работы с событиями виджетов был несколько изменен чтобы сделать его более
соответствующим работе с событиями всех прочих элементов страниц.

Во-первых, это означает, что все функции обратного вызова которые вы
подключаете к виджетам будут вызваны в контексте элемента виджета

    var slider = new Slider();
    
    slider.onChange(function() {
      this.getValue(); // возвращает текущее значение
      this.setClass('my-class'); 
    });

Во-вторых, вместо того чтобы передавать в слушателей целый зоопарк разных
атрибутов, все специальные данные теперь доступны через объект события,
например:

    var slider = new Slider();
    
    slider.onChange(function(event) {
      event.target; // -> ссылается на виджет слайдера
      event.value;  // -> указывает текущее значение
    });

В третьих, все виджеты имеют стандартные css классы, и т.к. все события теперь
всплывают по документу, вы можете использовать UJS возможности вместе с
виджетами

    "rui-slider".onChange(function() {
      // .....
    });

Все что доступно для обработки событий в объектами {Element}, все тоже самое
доступно и с виджетами.


## Унифицированная инициализация, :initialization

В RightJS UI 1 мы имели множество различных способов для автоматической
инициализации виджетов на тех или иных элементах страницы. Некоторые из них
использовали нестандартные `rel` атрибуты, некоторые использовали специальные
css классы, некоторые пользовались HTML5 атрибутами.

В RightJS UI 2 все это безобразие было приведено в единообразие и все виджеты
теперь инициализируются через HTML5 атрибуты выглядящие как
`data-имя-виджета`. Например:

    <input type="text" data-calendar="{format: 'US'}" />
    <input type="text" data-autocompleter="{url:'/boo'}" />

Если у вас нет опций, вы можете оставлять атрибуты пустыми или со значением
`'{}'`, работает и так и этак.

Единственное исключение - виджет [Lightbox](/ui/lightbox). Т.к. многие люди
уже привыкли к атрибуту `rel="lightbox"`, он был оставлен и вы можете его
использовать на равне с `data-lightbox` HTML5 атрибутом.


## Зачистка стилей, :styles

RightJS UI 1 был довольно спонтанно развивающимся проектом где все виджеты
были независимы друг от друга, со всеми вытекающими последствиями. В
RightJS 2 мы пытаемся эту ситуацию исправить.

Все стили были тщательно зачищены, сделаны более компактными и легкими для
изменений. Все RightJS UI css-классы получили стандартный префикс `rui-`,
вместо `right-` (который мог иногда вызывать коллизии). Все виджеты теперь
имеют стандартные css-классы, вида `rui-имя-виджета`.

И, что еще более важно, теперь мы имеем набор сквозных css-классов типа
`rui-panel`, `rui-button`, `rui-spinner` и т.д., что позволит нам легко и 
удобно создавать наборы визуальных стилей для виджетов.


## Мелкие фиксы, :fixes

Различные виджеты так же получили ряд мелких фиксов тут и там. Некоторые
виджеты имеют изменения в структуре HTML, некоторые имеют изменения в CSS
классах, у некоторых есть новые опции, и кое где были изменены i18n модули.

Поэтому если вы используете какие-то виджеты более чем "как есть", загляните
на их страницы в разделе [RightJS UI](/ui) и сверьтесь с тем что у вас есть.

