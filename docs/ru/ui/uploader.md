# Статус отправки

`Uploader` это простой виджет показывающий статус отправки формы на сервер,
что удобно в случае загрузки больших файлов, картинок и т.п.

<%= partial '/ui/head', :locals => {:name => 'uploader'} %>

<%= anchors_index %>

## Список особенностей, :features

* Очень простое использование
* Дизайн полность основан на HTML/CSS
* Все упаковано в один маленький (2.5к) файл

## Конфигурация на стороне сервера, :server

Данный скрипт работает со стандартными модулями статуса загрузки для
веб-серверов. Пожалуйста проследуйте по следующим ссылка за информацией по их
установке и настройке.

* [Apache](http://drogomir.com/blog/2008/6/18/upload-progress-bar-with-mod_passenger-and-apache)
* [Lighttpd](http://upload.lighttpd.net)
* [Nginx](http://wiki.nginx.org/NginxHttpUploadProgressModule)


## Основы использования, :usage

Использование данного скрипта очень простое. Все что для этого нужно, это
подключить скрипт на вашу страницу и добавить css-класс `with-progress` к
элементу нужной формы

    <script src=".../right-uploader.js"></script>

    <form class="with-progress" ...>
      ....
    </form>

После этого, перед отправкой данной формы, скрипт автоматически создаст
элемент прогресс-бара _внизу_ формы и будет обновлять его по мере отправки
данных на сервер.

Если вы хотите чтобы элемент прогресс-бара был расположен в любом другом месте
формы или имел дополнительные стили, вы можете создать его вручную, так как
это больше подходит для вашего случая

    <form class="with-progress">
      <div class="right-progress-bar"></div>

      <p>
        <input type="file" name="picture" />
        <input type="submit" value="Отправить" />
      </p>
    </form>

Вы можете создавать этот элемент пустым или со стандартным контентом, как это
описанно в [разделе стилей](#styles). В любом случае, скрипт попытается найти
ваш элемент по css-классу и будет использовать его в качестве текущего
прогресс-бара.

Вы так же можете испозовать данную функциональность программно с помощью
класса `Uploader`

    var uploader = new Uploader('my-form', {
      timeout: 400,
      onError: function() {
        alert("Сегодня ваши не пляшут");
      }
    });


## Список опций, :options

Существует следующий простой список опций которые можно использовать с данным
виджетом. Как обычно, вы можете изменять их глобально в переменной
`Uploader.Options`, использовать совместно с конструктором класса `Uploader`
а так же внутри специального атрибута `data-uploader-options`

Название    | Умолчание        | Описание
------------|------------------|----------------------------------------------
url         | '/progress'      | Адрес где запрашивать данные по статусу
param       | 'X-Progress-ID'  | Название параметра идентификатора загрузки
timeout     | 1000             | Таймаут в мс между опросами о статусе загрузки
round       | 0                | Сколько цифр после запятой нужно оставлять в статусе
fxDuration  | 400              | Длительность эффекта обновления. `0` - чтобы отключить
formCssRule | '.with-progress' | Css-правило для определения форм со статус баром


## Список событий, :events

Данный скрипт работает со следующим списком событий

Название | Описание
---------|--------------------------------------------------------
start    | когда загрузка началась
update   | когда статус загрузки был обновлен
finish   | когда загрузка была _успешно_ завершена
error    | когда загрузка была прервана _с ошибкой_

Все слушатели событий будут получать объект (хзш) со статусом загрузки,
полученным с сервера.


## Настройки стилей, :styles

Uploader - очень простой виджет имеющий следующую структуру:

    <div class="right-progress-bar">
      <div class="bar"></div>
      <div class="num">0%</div>
    </div>

В случае прерывания загрузки с шибкой, данный элемент так же получит
дополнительный css-класс `right-progress-bar-failed`.







